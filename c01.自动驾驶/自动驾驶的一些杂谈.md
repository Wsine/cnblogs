# 自动驾驶的一些杂谈

初入这个圈子，其实都是一些机缘巧合。

一开始的时候，我还在实习，那时候导师突然给我来电说有紧急的项目，我就离职回实验室了。然后经过沟通，他告诉的是关于自动驾驶的内容，在一辆真车上。那时候，我还真的有点震惊，也有点跃跃欲试。我觉得在玩车的路上，我还是挺有天赋的。第一次课程实践是关于控制小车的，那时候大家都比较懵懂，TA也没有讲清楚，但我凭借敏锐的直觉理解了电机驱动、GPIO、占空比等内容，在课程上算是带飞的大腿。其次，对于学院的新课程控制小船，难度升级了，但对于APM的理解，还是能完成实验，并将其写成博客，后来还成功主TA带来下一级的学生。由于前面的种种影响，对于这个课题我还是挺磨拳擦掌的。

### 如何选择一辆车进行自动驾驶实验

第一个项目是跟两家合作的。那时候做的一个惊人的文章title是在A地远程驾驶一辆在B地的真车，距离好像是有3000km吧。但是重点其实在于如何真实通过程序控制一辆真车。由此，涉及到的入门自动驾驶的一个问题，车辆选型问题。而这个答案就是，可线控。

线控是什么概念呢，就是整个车辆的运动能够被电子信号所控制。在这里基本可以将车辆分为两类：第一类是比较传统的车，使用的是传统的液压助力刹车装置，这一类刹车是纯机械结构，没有办法加入电子信号控制，最折中的办法也只能采取电机引线去拉刹车踏板，其余的控制信号倒可以接入车载网络（CAN）直接控制电子控制单元（ECU）。第二类车是新型的，带自适应巡航（ACC）的车辆，一个为了减轻驾驶员控制要求的功能，这类车一般采取电子信号的真空助力泵来控制制动系统，因此是可以将最关键的一个信号由电子信号控制的，也因此它成为了判断一辆车能否线控的最直观的标准。

不过呢，一般汽车信号都是加密走CAN网络的，协议都掌握在汽车厂商手中，截止2019年，市面上唯一公开的出售可线控的车辆仅有林肯MKZ，其余都需要通过合作的方式。

### 如何检验一辆车的控制效果的精细程度

当拥有了汽车的控制权后，到上文为止其实都是在通过软件转化人的行为到电子信号控制车辆，下一步的目标理所当然的要移除人的行为。所以会引入业界中比较好的控制算法来实现，但同时也会引入新的问题，控制算法的输入，车应该往哪开的问题。

业界给出的答案基本都是循迹，通过人工驾驶描点然后轨迹重放的方式，记录两次行车轨迹，对比差异能够评价一个控制算法的好坏。由于需要瞄点，这里会引入导航中比较精准的仪器，差分GPS设备，它的工作原理大概是这样的。你有两台GPS设备分别是基站（Base）和移动站（Rover），前提两台距离相近的GPS同时观测卫星得到的位置信息的误差Δ几乎是一致的（一般以Base为原点40km以内）。你已知Base的绝对正确的真实坐标为B，观测到的坐标为B‘，则误差Δ为B-B’，与此同时，Rover观测到的坐标为R‘，通过传递Δ到Rover，则Rover的真实坐标R为R’-Δ。

在实际的控制算法中分为横向控制和纵向控制，但由于设计场景不一样，考虑的基础单位也不一样。比如横向算法的偏转角，纵向算法的距离差或速度差。

### 感知算法的兵家必争之地

有了控制，感知成为下一阶段的目标。感知主要有三大武器：视觉感知，雷达感知和高精地图。

视觉感知的理论是靠摄像头感知图像，通过算法解析场景，尽可能模拟人类的驾驶行为。它的主要弊端在于：对光线的要求高，白天和黑夜有明显的差异；对可视角度（FOV）的要求高，人类尚且需要通过转头看更宽广的视野，摄像头会比较难处理这个问题。

雷达感知的理论是靠激光感知环境，通过算法还原场景。它的主要弊端在于：对天气的要求比较高，雨天和雪天会导致激光的反射收到严重影响。

高精地图的理论是提前获知场景的静态信息，几乎没有缺点，但实际应用中目前比较少区域能提供完整的高精地图，制作比较困难。

我的个人看法是这三种会相辅相成，不会由单一的感知方式引领，毕竟机器应该有机器的自有方式。

### 其他的要点

从学术上要解决的东西其实不多，但业界应用中要考虑的要点不少。比如：

- 导航功能
- 冗余的安全设计
- 配合感知算法的路径规划
- 系统集成与分工
- 成本问题
- 算力问题
- 续航问题

不过这些学术外的暂时就没有必要在这里讨论了，我也会长期关注自动驾驶的发展，后续可能也会更新。
